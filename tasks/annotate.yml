---
# yamllint disable rule:line-length
###############################################################################
# Annotate User Configuration
###############################################################################
# VSFTPd uses very specific and strict config format, sanitize and map settings
# to the equivalent role settings.
#
# A necessary evil given the limitations of argument_spec:
# * Strong validation and sanitization of user input.
# * Annotated variable providing context and rendering hints.
# * Logic updates centrally located in tasks.
# * Simplified role updates for variable changes.
# * All data touched by user is in a standard, expected format.
#
# Annotated Defaults:
# {VAR}: dict - Annotated and sanitized default variable.
#   section: str - Section name.
#   key: str - Config file key.
#   raw: any - Raw config file value (set from defaults > role defaults).
#   parsed: any - Processed raw config file value. Optional.
#   hint: str - Value rendering type hint (docstring types).
#   added: str - Release version variable added.
#       Special Case:
#         0.0.0: Unknown or since role inception.
#   sensitive: bool - True for PII/SPII data that should not be logged.
#   deprecated: bool - True if no longer used in current role release.
#   order: int - Order item should appear in rendered files.
#
# Generates:
#   _vsftpd_cfg_map: list of dict - Annotated config map.
#   _vsftpd_cfg_order: list of str - Config section order.
#
# Reference:
# * https://docs.paperless-ngx.com/setup/#bare_metal
# * https://docs.ansible.com/ansible/latest/dev_guide/developing_program_flow_modules.html#argument-spec
# * https://github.com/ansible/ansible/issues/77159
# yamllint enable rule:line-length

# TODO(trixie): Remove variable renaming check on next major vsftpd release.
- name: 'Annotate | check deprecated variable usage'
  when: >
    hostvars[inventory_hostname] | dict2items |
    selectattr("key", "match", "vsftpd_config_*") | length > 0 or
    hostvars[inventory_hostname] | dict2items |
    selectattr("key", "match", "vsftpd_service_*") | length > 0
  ansible.builtin.fail:
    msg: |
      âœ˜ Role variables have migrated. Read defaults and update.

      vsftpd_config_* -> vsftpd_cfg_*
      vsftpd_service_* -> vsftpd_srv_*
      vsftpd_* -> vsftpd_srv_*

- name: 'Annotate | sanitize & annotate config defaults'
  ansible.builtin.set_fact:
    vsftpd_cfg_accept_timeout: {
      section: 'Default',
      key: 'accept_timeout',
      raw: '{{ vsftpd_cfg_accept_timeout | default(60) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 1,
    }
    vsftpd_cfg_allow_anon_ssl: {
      section: 'Default',
      key: 'allow_anon_ssl',
      raw: '{{ vsftpd_cfg_allow_anon_ssl | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 2,
    }
    vsftpd_cfg_anon_max_rate: {
      section: 'Default',
      key: 'anon_max_rate',
      raw: '{{ vsftpd_cfg_anon_max_rate | default(0) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 3,
    }
    vsftpd_cfg_anon_mkdir_write_enable: {
      section: 'Default',
      key: 'anon_mkdir_write_enable',
      raw: '{{ vsftpd_cfg_anon_mkdir_write_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 4,
    }
    vsftpd_cfg_anon_other_write_enable: {
      section: 'Default',
      key: 'anon_other_write_enable',
      raw: '{{ vsftpd_cfg_anon_other_write_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 5,
    }
    vsftpd_cfg_anon_root: {
      section: 'Default',
      key: 'anon_root',
      raw: '{{ vsftpd_cfg_anon_root | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 6,
    }
    vsftpd_cfg_anon_umask: {
      section: 'Default',
      key: 'anon_umask',
      raw: '{{ vsftpd_cfg_anon_umask | default("077") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 7,
    }
    vsftpd_cfg_anon_upload_enable: {
      section: 'Default',
      key: 'anon_upload_enable',
      raw: '{{ vsftpd_cfg_anon_upload_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 8,
    }
    vsftpd_cfg_anon_world_readable_only: {
      section: 'Default',
      key: 'anon_world_readable_only',
      raw: '{{ vsftpd_cfg_anon_world_readable_only | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 9,
    }
    vsftpd_cfg_anonymous_enable: {
      section: 'Default',
      key: 'anonymous_enable',
      raw: '{{ vsftpd_cfg_anonymous_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 10,
    }
    vsftpd_cfg_ascii_download_enable: {
      section: 'Default',
      key: 'ascii_download_enable',
      raw: '{{ vsftpd_cfg_ascii_download_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 11,
    }
    vsftpd_cfg_ascii_upload_enable: {
      section: 'Default',
      key: 'ascii_upload_enable',
      raw: '{{ vsftpd_cfg_ascii_upload_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 12,
    }
    vsftpd_cfg_async_abor_enable: {
      section: 'Default',
      key: 'async_abor_enable',
      raw: '{{ vsftpd_cfg_async_abor_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 13,
    }
    vsftpd_cfg_background: {
      section: 'Default',
      key: 'background',
      raw: '{{ vsftpd_cfg_background | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 14,
    }
    vsftpd_cfg_banned_emails: {
      section: 'Default',
      key: 'banned_email_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/banned_emails"
        if vsftpd_cfg_banned_emails | default([]) | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_banned_emails | default([]) }}',
      hint: 'str',  # Autogenerated path from list.
      added: '0.0.0',
      sensitive: true,
      deprecated: false,
      order: 15,
    }
    vsftpd_cfg_banner: {
      section: 'Default',
      key: 'banner_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/banner_file"
        if vsftpd_cfg_banner | default("") | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_banner | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 16,
    }
    vsftpd_cfg_ca_certs_file: {
      section: 'Default',
      key: 'ca_certs_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/ca.cert"
        if vsftpd_cfg_ca_certs_file | default("") | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_ca_certs_file | default("") }}',
      hint: 'str',
      added: '2.0.6',
      sensitive: true,
      deprecated: false,
      order: 17,
    }
    vsftpd_cfg_check_shell: {
      section: 'Default',
      key: 'check_shell',
      raw: '{{ vsftpd_cfg_check_shell | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 18,
    }
    vsftpd_cfg_chmod_enable: {
      section: 'Default',
      key: 'chmod_enable',
      raw: '{{ vsftpd_cfg_chmod_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 19,
    }
    vsftpd_cfg_chown_upload_mode: {
      section: 'Default',
      key: 'chown_upload_mode',
      raw: '{{ vsftpd_cfg_chown_upload_mode | default("0600") }}',
      hint: 'str',
      added: '2.0.6',
      sensitive: false,
      deprecated: false,
      order: 20,
    }
    vsftpd_cfg_chown_uploads: {
      section: 'Default',
      key: 'chown_uploads',
      raw: '{{ vsftpd_cfg_chown_uploads | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 21,
    }
    vsftpd_cfg_chown_username: {
      section: 'Default',
      key: 'chown_username',
      raw: '{{ vsftpd_cfg_chown_username | default("root") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 22,
    }
    vsftpd_cfg_chroot_list_enable: {
      section: 'Default',
      key: 'chroot_list_enable',
      raw: '{{ vsftpd_cfg_chroot_list_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 23,
    }
    vsftpd_cfg_chroot_list: {
      section: 'Default',
      key: 'chroot_list_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/chroot_list"
        if vsftpd_cfg_chroot_list | default([]) | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_chroot_list | default([]) }}',
      hint: 'str',  # Autogenerated path from list.
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 24,
    }
    vsftpd_cfg_chroot_local_user: {
      section: 'Default',
      key: 'chroot_local_user',
      raw: '{{ vsftpd_cfg_chroot_local_user | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 25,
    }
    vsftpd_cfg_cmds_allowed: {
      section: 'Default',
      key: 'cmds_allowed',
      raw: '{{ vsftpd_cfg_cmds_allowed | default([]) | join(",") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 26,
    }
    vsftpd_cfg_cmds_denied: {
      section: 'Default',
      key: 'cmds_denied',
      raw: '{{ vsftpd_cfg_cmds_denied | default([]) | join(",") }}',
      hint: 'str',
      added: '2.1.0',
      sensitive: false,
      deprecated: false,
      order: 27,
    }
    vsftpd_cfg_connect_from_port_20: {
      section: 'Default',
      key: 'connect_from_port_20',
      raw: '{{ vsftpd_cfg_connect_from_port_20 | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 28,
    }
    vsftpd_cfg_connect_timeout: {
      section: 'Default',
      key: 'connect_timeout',
      raw: '{{ vsftpd_cfg_connect_timeout | default(60) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 29,
    }
    vsftpd_cfg_data_connection_timeout: {
      section: 'Default',
      key: 'data_connection_timeout',
      raw: '{{ vsftpd_cfg_data_connection_timeout | default(300) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 30,
    }
    vsftpd_cfg_debug_ssl: {
      section: 'Default',
      key: 'debug_ssl',
      raw: '{{ vsftpd_cfg_debug_ssl | default(false) }}',
      hint: 'bool',
      added: '2.0.6',
      sensitive: false,
      deprecated: false,
      order: 31,
    }
    vsftpd_cfg_delay_failed_login: {
      section: 'Default',
      key: 'delay_failed_login',
      raw: '{{ vsftpd_cfg_delay_failed_login | default(1) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 32,
    }
    vsftpd_cfg_delay_successful_login: {
      section: 'Default',
      key: 'delay_successful_login',
      raw: '{{ vsftpd_cfg_delay_successful_login | default(0) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 33,
    }
    vsftpd_cfg_delete_failed_uploads: {
      section: 'Default',
      key: 'delete_failed_uploads',
      raw: '{{ vsftpd_cfg_delete_failed_uploads | default(false) }}',
      hint: 'bool',
      added: '2.0.7',
      sensitive: false,
      deprecated: false,
      order: 34,
    }
    vsftpd_cfg_deny_email_enable: {
      section: 'Default',
      key: 'deny_email_enable',
      raw: '{{ vsftpd_cfg_deny_email_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 35,
    }
    vsftpd_cfg_deny_file: {
      section: 'Default',
      key: 'deny_file',
      raw: '{{
        "{" ~ vsftpd_cfg_deny_file | join(",") ~ "}"
        if vsftpd_cfg_deny_file | length > 0 else
        ""
      }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 36,
    }
    vsftpd_cfg_dirlist_enable: {
      section: 'Default',
      key: 'dirlist_enable',
      raw: '{{ vsftpd_cfg_dirlist_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 37,
    }
    vsftpd_cfg_dirmessage_enable: {
      section: 'Default',
      key: 'dirmessage_enable',
      raw: '{{ vsftpd_cfg_dirmessage_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 38,
    }
    vsftpd_cfg_download_enable: {
      section: 'Default',
      key: 'download_enable',
      raw: '{{ vsftpd_cfg_download_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 39,
    }
    vsftpd_cfg_download_file: {
      section: 'Default',
      key: 'download_file',
      raw: '{{
        "{" + vsftpd_cfg_download_file | join(",") + "}"
        if vsftpd_cfg_download_file | length > 0 else
        ""
      }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 40,
    }
    vsftpd_cfg_dsa_cert_file: {
      section: 'Default',
      key: 'dsa_cert_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/dsa.cert"
        if vsftpd_cfg_dsa_cert_file | default("") | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_dsa_cert_file | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: true,
      deprecated: false,
      order: 41,
    }
    vsftpd_cfg_dsa_private_key_file: {
      section: 'Default',
      key: 'dsa_private_key_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/dsa.key"
        if vsftpd_cfg_dsa_private_key_file | default("") | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_dsa_private_key_file | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: true,
      deprecated: false,
      order: 42,
    }
    vsftpd_cfg_dual_log_enable: {
      section: 'Default',
      key: 'dual_log_enable',
      raw: '{{ vsftpd_cfg_dual_log_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 43,
    }
    vsftpd_cfg_email_passwords: {
      section: 'Default',
      key: 'email_password_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/email_passwords"
        if vsftpd_cfg_email_passwords | default([]) | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_email_passwords | default([]) }}',
      hint: 'str',  # Autogenerated path from list.
      added: '0.0.0',
      sensitive: true,
      deprecated: false,
      order: 44,
    }
    vsftpd_cfg_file_open_mode: {
      section: 'Default',
      key: 'file_open_mode',
      raw: '{{ vsftpd_cfg_file_open_mode | default("0666") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 45,
    }
    vsftpd_cfg_force_anon_data_ssl: {
      section: 'Default',
      key: 'force_anon_data_ssl',
      raw: '{{ vsftpd_cfg_force_anon_data_ssl | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 46,
    }
    vsftpd_cfg_force_anon_logins_ssl: {
      section: 'Default',
      key: 'force_anon_logins_ssl',
      raw: '{{ vsftpd_cfg_force_anon_logins_ssl | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 47,
    }
    vsftpd_cfg_force_dot_files: {
      section: 'Default',
      key: 'force_dot_files',
      raw: '{{ vsftpd_cfg_force_dot_files | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 48,
    }
    vsftpd_cfg_force_local_data_ssl: {
      section: 'Default',
      key: 'force_local_data_ssl',
      raw: '{{ vsftpd_cfg_force_local_data_ssl | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 49,
    }
    vsftpd_cfg_force_local_logins_ssl: {
      section: 'Default',
      key: 'force_local_logins_ssl',
      raw: '{{ vsftpd_cfg_force_local_logins_ssl | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 50,
    }
    vsftpd_cfg_ftp_data_port: {
      section: 'Default',
      key: 'ftp_data_port',
      raw: '{{ vsftpd_cfg_ftp_data_port | default(20) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 51,
    }
    vsftpd_cfg_ftp_username: {
      section: 'Default',
      key: 'ftp_username',
      raw: '{{ vsftpd_cfg_ftp_username | default("ftp") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 52,
    }
    vsftpd_cfg_ftpd_banner: {
      section: 'Default',
      key: 'ftpd_banner',
      raw: '{{ vsftpd_cfg_ftpd_banner | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 53,
    }
    vsftpd_cfg_guest_enable: {
      section: 'Default',
      key: 'guest_enable',
      raw: '{{
        vsftpd_cfg_guest_enable | default(false) or
        vsftpd_srv_virtual_users | length > 0
      }}',  # Enable if virtual users set (guest_enable=true).
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 54,
    }
    vsftpd_cfg_guest_username: {
      section: 'Default',
      key: 'guest_username',
      raw: '{{ vsftpd_cfg_guest_username | default("ftp") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 55,
    }
    vsftpd_cfg_hide_file: {
      section: 'Default',
      key: 'hide_file',
      raw: '{{
        "{" + vsftpd_cfg_hide_file | join(",") + "}"
        if vsftpd_cfg_hide_file | length > 0 else
        ""
      }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 56,
    }
    vsftpd_cfg_hide_ids: {
      section: 'Default',
      key: 'hide_ids',
      raw: '{{ vsftpd_cfg_hide_ids | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 57,
    }
    vsftpd_cfg_idle_session_timeout: {
      section: 'Default',
      key: 'idle_session_timeout',
      raw: '{{ vsftpd_cfg_idle_session_timeout | default(300) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 58,
    }
    vsftpd_cfg_implicit_ssl: {
      section: 'Default',
      key: 'implicit_ssl',
      raw: '{{ vsftpd_cfg_implicit_ssl | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 59,
    }
    vsftpd_cfg_listen: {
      section: 'Default',
      key: 'listen',
      raw: '{{ vsftpd_cfg_listen | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 60,
    }
    vsftpd_cfg_listen_address6: {
      section: 'Default',
      key: 'listen_address6',
      raw: '{{ vsftpd_cfg_listen_address6 | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 61,
    }
    vsftpd_cfg_listen_address: {
      section: 'Default',
      key: 'listen_address',
      raw: '{{ vsftpd_cfg_listen_address | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 62,
    }
    vsftpd_cfg_listen_ipv6: {
      section: 'Default',
      key: 'listen_ipv6',
      raw: '{{ vsftpd_cfg_listen_ipv6 | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 63,
    }
    vsftpd_cfg_listen_port: {
      section: 'Default',
      key: 'listen_port',
      raw: '{{ vsftpd_cfg_listen_port | default(21) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 64,
    }
    vsftpd_cfg_local_enable: {
      section: 'Default',
      key: 'local_enable',
      raw: '{{ vsftpd_cfg_local_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 65,
    }
    vsftpd_cfg_local_max_rate: {
      section: 'Default',
      key: 'local_max_rate',
      raw: '{{ vsftpd_cfg_local_max_rate | default(0) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 66,
    }
    vsftpd_cfg_local_root: {
      section: 'Default',
      key: 'local_root',
      raw: '{{ vsftpd_cfg_local_root | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 67,
    }
    vsftpd_cfg_local_umask: {
      section: 'Default',
      key: 'local_umask',
      raw: '{{ vsftpd_cfg_local_umask | default("077") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 68,
    }
    vsftpd_cfg_lock_upload_files: {
      section: 'Default',
      key: 'lock_upload_files',
      raw: '{{ vsftpd_cfg_lock_upload_files | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 69,
    }
    vsftpd_cfg_log_ftp_protocol: {
      section: 'Default',
      key: 'log_ftp_protocol',
      raw: '{{ vsftpd_cfg_log_ftp_protocol | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 70,
    }
    vsftpd_cfg_ls_recurse_enable: {
      section: 'Default',
      key: 'ls_recurse_enable',
      raw: '{{ vsftpd_cfg_ls_recurse_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 71,
    }
    vsftpd_cfg_max_clients: {
      section: 'Default',
      key: 'max_clients',
      raw: '{{ vsftpd_cfg_max_clients | default(2000) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 72,
    }
    vsftpd_cfg_max_login_fails: {
      section: 'Default',
      key: 'max_login_fails',
      raw: '{{ vsftpd_cfg_max_login_fails | default(3) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 73,
    }
    vsftpd_cfg_max_per_ip: {
      section: 'Default',
      key: 'max_per_ip',
      raw: '{{ vsftpd_cfg_max_per_ip | default(50) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 74,
    }
    vsftpd_cfg_mdtm_write: {
      section: 'Default',
      key: 'mdtm_write',
      raw: '{{ vsftpd_cfg_mdtm_write | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 75,
    }
    vsftpd_cfg_message_file: {
      section: 'Default',
      key: 'message_file',
      raw: '{{ vsftpd_cfg_message_file | default(".message") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 76,
    }
    vsftpd_cfg_no_anon_password: {
      section: 'Default',
      key: 'no_anon_password',
      raw: '{{ vsftpd_cfg_no_anon_password | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 77,
    }
    vsftpd_cfg_no_log_lock: {
      section: 'Default',
      key: 'no_log_lock',
      raw: '{{ vsftpd_cfg_no_log_lock | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 78,
    }
    vsftpd_cfg_nopriv_user: {
      section: 'Default',
      key: 'nopriv_user',
      raw: '{{ vsftpd_cfg_nopriv_user | default("nobody") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 79,
    }
    vsftpd_cfg_one_process_model: {
      section: 'Default',
      key: 'one_process_model',
      raw: '{{ vsftpd_cfg_one_process_model | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 80,
    }
    vsftpd_cfg_pam_service_name: {
      section: 'Default',
      key: 'pam_service_name',
      raw: '{{
        "vsftpd_virtual"
        if vsftpd_srv_virtual_users | length > 0 else
        vsftpd_cfg_pam_service_name | default("vsftpd")
      }}',  # Enable if virtual users set (vsftpd_virtual module).
      parsed: '{{
        vsftpd_role_pam_dir ~ "/vsftpd_virtual"
        if vsftpd_srv_virtual_users | length > 0 else
        vsftpd_role_pam_dir ~ "/" ~ vsftpd_cfg_pam_service_name |
          default("vsftpd")
      }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 81,
    }
    vsftpd_cfg_passwd_chroot_enable: {
      section: 'Default',
      key: 'passwd_chroot_enable',
      raw: '{{ vsftpd_cfg_passwd_chroot_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 82,
    }
    vsftpd_cfg_pasv_addr_resolve: {
      section: 'Default',
      key: 'pasv_addr_resolve',
      raw: '{{ vsftpd_cfg_pasv_addr_resolve | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 83,
    }
    vsftpd_cfg_pasv_address: {
      section: 'Default',
      key: 'pasv_address',
      raw: '{{ vsftpd_cfg_pasv_address | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 84,
    }
    vsftpd_cfg_pasv_enable: {
      section: 'Default',
      key: 'pasv_enable',
      raw: '{{ vsftpd_cfg_pasv_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 85,
    }
    vsftpd_cfg_pasv_max_port: {
      section: 'Default',
      key: 'pasv_max_port',
      raw: '{{ vsftpd_cfg_pasv_max_port | default(0) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 86,
    }
    vsftpd_cfg_pasv_min_port: {
      section: 'Default',
      key: 'pasv_min_port',
      raw: '{{ vsftpd_cfg_pasv_min_port | default(0) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 87,
    }
    vsftpd_cfg_pasv_promiscuous: {
      section: 'Default',
      key: 'pasv_promiscuous',
      raw: '{{ vsftpd_cfg_pasv_promiscuous | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 88,
    }
    vsftpd_cfg_port_enable: {
      section: 'Default',
      key: 'port_enable',
      raw: '{{ vsftpd_cfg_port_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 89,
    }
    vsftpd_cfg_port_promiscuous: {
      section: 'Default',
      key: 'port_promiscuous',
      raw: '{{ vsftpd_cfg_port_promiscuous | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 90,
    }
    vsftpd_cfg_require_cert: {
      section: 'Default',
      key: 'require_cert',
      raw: '{{ vsftpd_cfg_require_cert | default(false) }}',
      hint: 'bool',
      added: '2.0.6',
      sensitive: false,
      deprecated: false,
      order: 91,
    }
    vsftpd_cfg_require_ssl_reuse: {
      section: 'Default',
      key: 'require_ssl_reuse',
      raw: '{{ vsftpd_cfg_require_ssl_reuse | default(true) }}',
      hint: 'bool',
      added: '2.1.0',
      sensitive: false,
      deprecated: false,
      order: 92,
    }
    vsftpd_cfg_rsa_cert_file: {
      section: 'Default',
      key: 'rsa_cert_file',
      raw: '{{
        "/usr/share/ssl/certs/vsftpd.pem"
        if vsftpd_cfg_rsa_cert_file | default("") | length == 0 else
        vsftpd_role_service_dir ~ "/rsa.pem"
      }}',
      parsed: '{{ vsftpd_cfg_rsa_cert_file | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: true,
      deprecated: false,
      order: 93,
    }
    vsftpd_cfg_rsa_private_key_file: {
      section: 'Default',
      key: 'rsa_private_key_file',
      raw: '{{
        "/etc/ssl/private/ssl-cert-snakeoil.key"
        if vsftpd_cfg_rsa_private_key_file | default("") | length == 0 else
        vsftpd_role_service_dir ~ "/rsa.key"
      }}',
      parsed: '{{ vsftpd_cfg_rsa_private_key_file | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: true,
      deprecated: false,
      order: 94,
    }
    vsftpd_cfg_run_as_launching_user: {
      section: 'Default',
      key: 'run_as_launching_user',
      raw: '{{ vsftpd_cfg_run_as_launching_user | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 95,
    }
    vsftpd_cfg_secure_chroot_dir: {
      section: 'Default',
      key: 'secure_chroot_dir',
      raw:
        '{{ vsftpd_cfg_secure_chroot_dir | default("/usr/share/empty") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 96,
    }
    vsftpd_cfg_secure_email_list_enable: {
      section: 'Default',
      key: 'secure_email_list_enable',
      raw: '{{ vsftpd_cfg_secure_email_list_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 97,
    }
    vsftpd_cfg_session_support: {
      section: 'Default',
      key: 'session_support',
      raw: '{{ vsftpd_cfg_session_support | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 98,
    }
    vsftpd_cfg_setproctitle_enable: {
      section: 'Default',
      key: 'setproctitle_enable',
      raw: '{{ vsftpd_cfg_setproctitle_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 99,
    }
    vsftpd_cfg_ssl_ciphers: {
      section: 'Default',
      key: 'ssl_ciphers',
      raw: '{{ vsftpd_cfg_ssl_ciphers | default("DES-CBC3-SHA") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 100,
    }
    vsftpd_cfg_ssl_enable: {
      section: 'Default',
      key: 'ssl_enable',
      raw: '{{ vsftpd_cfg_ssl_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 101,
    }
    vsftpd_cfg_ssl_request_cert: {
      section: 'Default',
      key: 'ssl_request_cert',
      raw: '{{ vsftpd_cfg_ssl_request_cert | default(true) }}',
      hint: 'bool',
      added: '2.0.7',
      sensitive: true,
      deprecated: false,
      order: 102,
    }
    vsftpd_cfg_ssl_sslv2: {
      section: 'Default',
      key: 'ssl_sslv2',
      raw: '{{ vsftpd_cfg_ssl_sslv2 | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 103,
    }
    vsftpd_cfg_ssl_sslv3: {
      section: 'Default',
      key: 'ssl_sslv3',
      raw: '{{ vsftpd_cfg_ssl_sslv3 | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 104,
    }
    vsftpd_cfg_ssl_tlsv1: {
      section: 'Default',
      key: 'ssl_tlsv1',
      raw: '{{ vsftpd_cfg_ssl_tlsv1 | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 105,
    }
    vsftpd_cfg_strict_ssl_read_eof: {
      section: 'Default',
      key: 'strict_ssl_read_eof',
      raw: '{{ vsftpd_cfg_strict_ssl_read_eof | default(false) }}',
      hint: 'bool',
      added: '2.00.7',
      sensitive: false,
      deprecated: false,
      order: 106,
    }
    vsftpd_cfg_strict_ssl_write_shutdown: {
      section: 'Default',
      key: 'strict_ssl_write_shutdown',
      raw: '{{ vsftpd_cfg_strict_ssl_write_shutdown | default(false) }}',
      hint: 'bool',
      added: '2.0.7',
      sensitive: false,
      deprecated: false,
      order: 107,
    }
    vsftpd_cfg_syslog_enable: {
      section: 'Default',
      key: 'syslog_enable',
      raw: '{{ vsftpd_cfg_syslog_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 108,
    }
    vsftpd_cfg_tcp_wrappers: {
      section: 'Default',
      key: 'tcp_wrappers',
      raw: '{{ vsftpd_cfg_tcp_wrappers | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 109,
    }
    vsftpd_cfg_text_userdb_names: {
      section: 'Default',
      key: 'text_userdb_names',
      raw: '{{ vsftpd_cfg_text_userdb_names | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 110,
    }
    vsftpd_cfg_tilde_user_enable: {
      section: 'Default',
      key: 'tilde_user_enable',
      raw: '{{ vsftpd_cfg_tilde_user_enable | default(false) }}',
      hint: 'bool',
      added: '0.10.0',
      sensitive: false,
      deprecated: false,
      order: 111,
    }
    vsftpd_cfg_trans_chunk_size: {
      section: 'Default',
      key: 'trans_chunk_size',
      raw: '{{ vsftpd_cfg_trans_chunk_size | default(0) }}',
      hint: 'int',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 112,
    }
    vsftpd_cfg_upload_file: {
      section: 'Default',
      key: 'upload_file',
      raw: '{{
        "{" + vsftpd_cfg_upload_file | join(",") + "}"
        if vsftpd_cfg_upload_file | length > 0 else
        ""
      }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 113,
    }
    vsftpd_cfg_use_localtime: {
      section: 'Default',
      key: 'use_localtime',
      raw: '{{ vsftpd_cfg_use_localtime | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 114,
    }
    vsftpd_cfg_use_sendfile: {
      section: 'Default',
      key: 'use_sendfile',
      raw: '{{ vsftpd_cfg_use_sendfile | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 115,
    }
    vsftpd_cfg_user_config_dir: {
      section: 'Default',
      key: 'user_config_dir',
      raw: '{{
        vsftpd_role_service_dir ~ "/user_config"
        if vsftpd_cfg_user_config_dir | default("") | length > 0 else
        ""
      }}',
      parsed: '{{
        vsftpd_cfg_user_config_dir | default("")
        if (vsftpd_cfg_user_config_dir | default("")).endswith("/") else
        vsftpd_cfg_user_config_dir | default("") ~ "/"
      }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 116,
    }
    vsftpd_cfg_user_sub_token: {
      section: 'Default',
      key: 'user_sub_token',
      raw: '{{ vsftpd_cfg_user_sub_token | default("") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 117,
    }
    vsftpd_cfg_userlist_deny: {
      section: 'Default',
      key: 'userlist_deny',
      raw: '{{ vsftpd_cfg_userlist_deny | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 118,
    }
    vsftpd_cfg_userlist_enable: {
      section: 'Default',
      key: 'userlist_enable',
      raw: '{{ vsftpd_cfg_userlist_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 119,
    }
    vsftpd_cfg_userlist: {
      section: 'Default',
      key: 'userlist_file',
      raw: '{{
        vsftpd_role_service_dir ~ "/user_list"
        if vsftpd_cfg_userlist | default([]) | length > 0 else
        ""
      }}',
      parsed: '{{ vsftpd_cfg_userlist | default([]) }}',
      hint: 'str',  # Autogenerated path from list.
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 120,
    }
    vsftpd_cfg_validate_cert: {
      section: 'Default',
      key: 'validate_cert',
      raw: '{{ vsftpd_cfg_validate_cert | default(false) }}',
      hint: 'bool',
      added: '2.0.6',
      sensitive: false,
      deprecated: false,
      order: 121,
    }
    vsftpd_cfg_vsftpd_log_file: {
      section: 'Default',
      key: 'vsftpd_log_file',
      raw:
        '{{ vsftpd_cfg_vsftpd_log_file | default("/var/log/vsftpd.log") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 122,
    }
    vsftpd_cfg_virtual_use_local_privs: {
      section: 'Default',
      key: 'virtual_use_local_privs',
      raw: '{{ vsftpd_cfg_virtual_use_local_privs | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 123,
    }
    vsftpd_cfg_write_enable: {
      section: 'Default',
      key: 'write_enable',
      raw: '{{ vsftpd_cfg_write_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 124,
    }
    vsftpd_cfg_xferlog_enable: {
      section: 'Default',
      key: 'xferlog_enable',
      raw: '{{ vsftpd_cfg_xferlog_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 125,
    }
    vsftpd_cfg_xferlog_file: {
      section: 'Default',
      key: 'xferlog_file',
      raw: '{{ vsftpd_cfg_xferlog_file | default("/var/log/xferlog") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 126,
    }
    vsftpd_cfg_xferlog_std_format: {
      section: 'Default',
      key: 'xferlog_std_format',
      raw: '{{ vsftpd_cfg_xferlog_std_format | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 127,
    }
    vsftpd_cfg_debian_utf8_filesystem: {
      section: 'Debian Specific Patches',
      key: 'utf8_filesystem',
      raw: '{{ vsftpd_cfg_debian_utf8_filesystem | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 128,
    }

- name: 'Annotate | sanitize & annotate service defaults'
  ansible.builtin.set_fact:
    vsftpd_srv_virtual_users: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_virtual_users | default([]) }}',
      parsed: '{{
        vsftpd_role_service_dir ~ "/virtual_users"
        if vsftpd_srv_virtual_users | default([]) | length > 0 else
        ""
      }}',
      hint: 'list',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 1,
    }
    vsftpd_srv_harden_enable: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_harden_enable | default(false) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 2,
    }
    vsftpd_srv_harden_rw_paths: {
      section: '',
      key: '',
      raw: '{{
        vsftpd_srv_harden_rw_paths |
        default([vsftpd_cfg_local_root.raw,
                 vsftpd_cfg_anon_root.raw,
                 vsftpd_cfg_vsftpd_log_file.raw,
                 vsftpd_cfg_xferlog_file.raw,
                 "/srv/ftp"])
      }}',
      hint: 'list',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 3,
    }
    vsftpd_srv_harden_ro_paths: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_harden_ro_paths | default([]) }}',
      hint: 'list',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 4,
    }
    vsftpd_srv_harden_inaccessible_paths: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_harden_inaccessible_paths | default([]) }}',
      hint: 'list',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 5,
    }
    vsftpd_srv_user: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_user | default("ftp") }}',
      parsed: '',  # Updated with UID when determined in prep.
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 6,
    }
    vsftpd_srv_user_home_mode: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_user_home_mode | default("0755") }}',
      parsed: '',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 7,
    }
    vsftpd_srv_group: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_group | default("ftp") }}',
      parsed: '',  # Updated with GID when determined in prep.
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 8,
    }
    vsftpd_srv_create_user: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_create_user | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 9,
    }
    vsftpd_srv_user_data_manage_enable: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_user_data_manage_enable | default(false) }}',
      hint: 'bool',
      added: '3.0.0',
      sensitive: false,
      deprecated: false,
      order: 10,
    }
    vsftpd_srv_local_root_user: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_local_root_user | default("ftp") }}',
      parsed: '',  # Updated with UID when determined in prep.
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 11,
    }
    vsftpd_srv_local_root_group: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_local_root_group | default("ftp") }}',
      parsed: '',  # Updated with GID when determined in prep.
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 12,
    }
    vsftpd_srv_local_root_mode: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_local_root_mode | default("0770") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 13,
    }
    vsftpd_srv_local_root_recursive_enable: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_local_root_recursive_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 14,
    }
    vsftpd_srv_anon_root_user: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_anon_root_user | default("ftp") }}',
      parsed: '',  # Updated with UID when determined in prep.
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 15,
    }
    vsftpd_srv_anon_root_group: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_anon_root_group | default("ftp") }}',
      parsed: '',  # Updated with GID when determined in prep.
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 16
    }
    vsftpd_srv_anon_root_mode: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_anon_root_mode | default("0770") }}',
      hint: 'str',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 17,
    }
    vsftpd_srv_anon_root_recursive_enable: {
      section: '',
      key: '',
      raw: '{{ vsftpd_srv_anon_root_recursive_enable | default(true) }}',
      hint: 'bool',
      added: '0.0.0',
      sensitive: false,
      deprecated: false,
      order: 18,
    }

- name: 'Annotate | generate config map'
  ansible.builtin.set_fact:
    _vsftpd_cfg_map: '{{
        hostvars[inventory_hostname] | dict2items |
        selectattr("key", "match", "vsftpd_cfg_*")
      }}'
    _vsftpd_cfg_order:
      - 'Default'
      - 'Debian Specific Patches'
